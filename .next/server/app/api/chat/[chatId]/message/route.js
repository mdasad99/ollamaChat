"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/[chatId]/message/route";
exports.ids = ["app/api/chat/[chatId]/message/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("pg");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&page=%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute.ts&appDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&page=%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute.ts&appDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_mdasa_Desktop_ollamaChat_app_api_chat_chatId_message_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/[chatId]/message/route.ts */ \"(rsc)/./app/api/chat/[chatId]/message/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/[chatId]/message/route\",\n        pathname: \"/api/chat/[chatId]/message\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/[chatId]/message/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\mdasa\\\\Desktop\\\\ollamaChat\\\\app\\\\api\\\\chat\\\\[chatId]\\\\message\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_mdasa_Desktop_ollamaChat_app_api_chat_chatId_message_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/chat/[chatId]/message/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGJTVCY2hhdElkJTVEJTJGbWVzc2FnZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRiU1QmNoYXRJZCU1RCUyRm1lc3NhZ2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjaGF0JTJGJTVCY2hhdElkJTVEJTJGbWVzc2FnZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNtZGFzYSU1Q0Rlc2t0b3AlNUNvbGxhbWFDaGF0JTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNtZGFzYSU1Q0Rlc2t0b3AlNUNvbGxhbWFDaGF0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNrQztBQUMvRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2xvY2FsLWNoYXRncHQtb2xsYW1hLz8wNmU3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXG1kYXNhXFxcXERlc2t0b3BcXFxcb2xsYW1hQ2hhdFxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxcW2NoYXRJZF1cXFxcbWVzc2FnZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY2hhdC9bY2hhdElkXS9tZXNzYWdlL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hhdC9bY2hhdElkXS9tZXNzYWdlXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L1tjaGF0SWRdL21lc3NhZ2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxtZGFzYVxcXFxEZXNrdG9wXFxcXG9sbGFtYUNoYXRcXFxcYXBwXFxcXGFwaVxcXFxjaGF0XFxcXFtjaGF0SWRdXFxcXG1lc3NhZ2VcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NoYXQvW2NoYXRJZF0vbWVzc2FnZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&page=%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute.ts&appDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/[chatId]/message/route.ts":
/*!************************************************!*\
  !*** ./app/api/chat/[chatId]/message/route.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../lib/db */ \"(rsc)/./lib/db.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_lib_db__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n\n\n\nasync function POST(request, { params }) {\n    try {\n        const { chatId } = params;\n        const { content } = await request.json();\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1___default().query(\"INSERT INTO messages (id, chat_id, role, content) VALUES ($1, $2, $3, $4)\", [\n            (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n            chatId,\n            \"user\",\n            content\n        ]);\n        const encoder = new TextEncoder();\n        const stream = new ReadableStream({\n            async start (controller) {\n                try {\n                    const ollamaResponse = await fetch(\"http://localhost:11434/api/generate\", {\n                        method: \"POST\",\n                        headers: {\n                            \"Content-Type\": \"application/json\"\n                        },\n                        body: JSON.stringify({\n                            model: \"gemma3:1b\",\n                            prompt: content,\n                            stream: true\n                        })\n                    });\n                    if (!ollamaResponse.ok) {\n                        throw new Error(\"Ollama API error\");\n                    }\n                    const reader = ollamaResponse.body?.getReader();\n                    if (!reader) throw new Error(\"No response body\");\n                    let assistantResponse = \"\";\n                    let buffer = \"\";\n                    while(true){\n                        const { done, value } = await reader.read();\n                        if (done) break;\n                        buffer += new TextDecoder().decode(value);\n                        const lines = buffer.split(\"\\n\");\n                        buffer = lines.pop() || \"\";\n                        for (const line of lines){\n                            if (!line.trim()) continue;\n                            try {\n                                const data = JSON.parse(line);\n                                if (data.response && data.response.length > 0) {\n                                    assistantResponse += data.response;\n                                    const sseData = `data: ${JSON.stringify({\n                                        token: data.response\n                                    })}\\n\\n`;\n                                    controller.enqueue(encoder.encode(sseData));\n                                }\n                                if (data.done === true) {\n                                    await _lib_db__WEBPACK_IMPORTED_MODULE_1___default().query(\"INSERT INTO messages (id, chat_id, role, content) VALUES ($1, $2, $3, $4)\", [\n                                        (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                                        chatId,\n                                        \"assistant\",\n                                        assistantResponse\n                                    ]);\n                                    const messageCount = await _lib_db__WEBPACK_IMPORTED_MODULE_1___default().query(\"SELECT COUNT(*) FROM messages WHERE chat_id = $1\", [\n                                        chatId\n                                    ]);\n                                    if (parseInt(messageCount.rows[0].count) === 2) {\n                                        const title = content.length > 50 ? content.substring(0, 50) + \"...\" : content;\n                                        await _lib_db__WEBPACK_IMPORTED_MODULE_1___default().query(\"UPDATE chats SET title = $1 WHERE id = $2\", [\n                                            title,\n                                            chatId\n                                        ]);\n                                    }\n                                    const doneData = `data: ${JSON.stringify({\n                                        done: true\n                                    })}\\n\\n`;\n                                    controller.enqueue(encoder.encode(doneData));\n                                    return;\n                                }\n                            } catch (e) {\n                                console.error(\"JSON parse error:\", e, \"Line:\", line);\n                            }\n                        }\n                    }\n                } catch (error) {\n                    console.error(\"Streaming error:\", error);\n                    const errorData = `data: ${JSON.stringify({\n                        error: \"Failed to generate response\"\n                    })}\\n\\n`;\n                    controller.enqueue(encoder.encode(errorData));\n                } finally{\n                    controller.close();\n                }\n            }\n        });\n        return new Response(stream, {\n            headers: {\n                \"Content-Type\": \"text/event-stream\",\n                \"Cache-Control\": \"no-cache\",\n                \"Connection\": \"keep-alive\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Error sending message:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to send message\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2NoYXQvW2NoYXRJZF0vbWVzc2FnZS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF1RDtBQUNmO0FBQ0w7QUFFNUIsZUFBZUksS0FDcEJDLE9BQW9CLEVBQ3BCLEVBQUVDLE1BQU0sRUFBa0M7SUFFMUMsSUFBSTtRQUNGLE1BQU0sRUFBRUMsTUFBTSxFQUFFLEdBQUdEO1FBQ25CLE1BQU0sRUFBRUUsT0FBTyxFQUFFLEdBQUcsTUFBTUgsUUFBUUksSUFBSTtRQUV0QyxNQUFNUixvREFBVSxDQUNkLDZFQUNBO1lBQUNFLGdEQUFNQTtZQUFJSTtZQUFRO1lBQVFDO1NBQVE7UUFHckMsTUFBTUcsVUFBVSxJQUFJQztRQUVwQixNQUFNQyxTQUFTLElBQUlDLGVBQWU7WUFDaEMsTUFBTUMsT0FBTUMsVUFBVTtnQkFDcEIsSUFBSTtvQkFDRixNQUFNQyxpQkFBaUIsTUFBTUMsTUFBTSx1Q0FBdUM7d0JBQ3hFQyxRQUFRO3dCQUNSQyxTQUFTOzRCQUFFLGdCQUFnQjt3QkFBbUI7d0JBQzlDQyxNQUFNQyxLQUFLQyxTQUFTLENBQUM7NEJBQ25CQyxPQUFPOzRCQUNQQyxRQUFRakI7NEJBQ1JLLFFBQVE7d0JBQ1Y7b0JBQ0Y7b0JBRUEsSUFBSSxDQUFDSSxlQUFlUyxFQUFFLEVBQUU7d0JBQ3RCLE1BQU0sSUFBSUMsTUFBTTtvQkFDbEI7b0JBRUEsTUFBTUMsU0FBU1gsZUFBZUksSUFBSSxFQUFFUTtvQkFDcEMsSUFBSSxDQUFDRCxRQUFRLE1BQU0sSUFBSUQsTUFBTTtvQkFFN0IsSUFBSUcsb0JBQW9CO29CQUN4QixJQUFJQyxTQUFTO29CQUViLE1BQU8sS0FBTTt3QkFDWCxNQUFNLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUwsT0FBT00sSUFBSTt3QkFDekMsSUFBSUYsTUFBTTt3QkFFVkQsVUFBVSxJQUFJSSxjQUFjQyxNQUFNLENBQUNIO3dCQUVuQyxNQUFNSSxRQUFRTixPQUFPTyxLQUFLLENBQUM7d0JBQzNCUCxTQUFTTSxNQUFNRSxHQUFHLE1BQU07d0JBRXhCLEtBQUssTUFBTUMsUUFBUUgsTUFBTzs0QkFDeEIsSUFBSSxDQUFDRyxLQUFLQyxJQUFJLElBQUk7NEJBRWxCLElBQUk7Z0NBQ0YsTUFBTUMsT0FBT3BCLEtBQUtxQixLQUFLLENBQUNIO2dDQUV4QixJQUFJRSxLQUFLRSxRQUFRLElBQUlGLEtBQUtFLFFBQVEsQ0FBQ0MsTUFBTSxHQUFHLEdBQUc7b0NBQzdDZixxQkFBcUJZLEtBQUtFLFFBQVE7b0NBRWxDLE1BQU1FLFVBQVUsQ0FBQyxNQUFNLEVBQUV4QixLQUFLQyxTQUFTLENBQUM7d0NBQUV3QixPQUFPTCxLQUFLRSxRQUFRO29DQUFDLEdBQUcsSUFBSSxDQUFDO29DQUN2RTVCLFdBQVdnQyxPQUFPLENBQUNyQyxRQUFRc0MsTUFBTSxDQUFDSDtnQ0FDcEM7Z0NBRUEsSUFBSUosS0FBS1YsSUFBSSxLQUFLLE1BQU07b0NBQ3RCLE1BQU0vQixvREFBVSxDQUNkLDZFQUNBO3dDQUFDRSxnREFBTUE7d0NBQUlJO3dDQUFRO3dDQUFhdUI7cUNBQWtCO29DQUdwRCxNQUFNb0IsZUFBZSxNQUFNakQsb0RBQVUsQ0FDbkMsb0RBQ0E7d0NBQUNNO3FDQUFPO29DQUdWLElBQUk0QyxTQUFTRCxhQUFhRSxJQUFJLENBQUMsRUFBRSxDQUFDQyxLQUFLLE1BQU0sR0FBRzt3Q0FDOUMsTUFBTUMsUUFBUTlDLFFBQVFxQyxNQUFNLEdBQUcsS0FBS3JDLFFBQVErQyxTQUFTLENBQUMsR0FBRyxNQUFNLFFBQVEvQzt3Q0FDdkUsTUFBTVAsb0RBQVUsQ0FDZCw2Q0FDQTs0Q0FBQ3FEOzRDQUFPL0M7eUNBQU87b0NBRW5CO29DQUVBLE1BQU1pRCxXQUFXLENBQUMsTUFBTSxFQUFFbEMsS0FBS0MsU0FBUyxDQUFDO3dDQUFFUyxNQUFNO29DQUFLLEdBQUcsSUFBSSxDQUFDO29DQUM5RGhCLFdBQVdnQyxPQUFPLENBQUNyQyxRQUFRc0MsTUFBTSxDQUFDTztvQ0FDbEM7Z0NBQ0Y7NEJBQ0YsRUFBRSxPQUFPQyxHQUFHO2dDQUNWQyxRQUFRQyxLQUFLLENBQUMscUJBQXFCRixHQUFHLFNBQVNqQjs0QkFDakQ7d0JBQ0Y7b0JBQ0Y7Z0JBQ0YsRUFBRSxPQUFPbUIsT0FBTztvQkFDZEQsUUFBUUMsS0FBSyxDQUFDLG9CQUFvQkE7b0JBQ2xDLE1BQU1DLFlBQVksQ0FBQyxNQUFNLEVBQUV0QyxLQUFLQyxTQUFTLENBQUM7d0JBQUVvQyxPQUFPO29CQUE4QixHQUFHLElBQUksQ0FBQztvQkFDekYzQyxXQUFXZ0MsT0FBTyxDQUFDckMsUUFBUXNDLE1BQU0sQ0FBQ1c7Z0JBQ3BDLFNBQVU7b0JBQ1I1QyxXQUFXNkMsS0FBSztnQkFDbEI7WUFDRjtRQUNGO1FBRUEsT0FBTyxJQUFJQyxTQUFTakQsUUFBUTtZQUMxQk8sU0FBUztnQkFDUCxnQkFBZ0I7Z0JBQ2hCLGlCQUFpQjtnQkFDakIsY0FBYztZQUNoQjtRQUNGO0lBQ0YsRUFBRSxPQUFPdUMsT0FBTztRQUNkRCxRQUFRQyxLQUFLLENBQUMsMEJBQTBCQTtRQUN4QyxPQUFPM0QscURBQVlBLENBQUNTLElBQUksQ0FBQztZQUFFa0QsT0FBTztRQUF5QixHQUFHO1lBQUVJLFFBQVE7UUFBSTtJQUM5RTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbG9jYWwtY2hhdGdwdC1vbGxhbWEvLi9hcHAvYXBpL2NoYXQvW2NoYXRJZF0vbWVzc2FnZS9yb3V0ZS50cz8yMzRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHBvb2wgZnJvbSAnLi4vLi4vLi4vLi4vLi4vbGliL2RiJ1xyXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJ1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QoXHJcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXHJcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgY2hhdElkOiBzdHJpbmcgfSB9XHJcbikge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IGNoYXRJZCB9ID0gcGFyYW1zXHJcbiAgICBjb25zdCB7IGNvbnRlbnQgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICBcclxuICAgIGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgICdJTlNFUlQgSU5UTyBtZXNzYWdlcyAoaWQsIGNoYXRfaWQsIHJvbGUsIGNvbnRlbnQpIFZBTFVFUyAoJDEsICQyLCAkMywgJDQpJyxcclxuICAgICAgW3V1aWR2NCgpLCBjaGF0SWQsICd1c2VyJywgY29udGVudF1cclxuICAgIClcclxuICAgIFxyXG4gICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpXHJcbiAgICBcclxuICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XHJcbiAgICAgIGFzeW5jIHN0YXJ0KGNvbnRyb2xsZXIpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3Qgb2xsYW1hUmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cDovL2xvY2FsaG9zdDoxMTQzNC9hcGkvZ2VuZXJhdGUnLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgIG1vZGVsOiAnZ2VtbWEzOjFiJyxcclxuICAgICAgICAgICAgICBwcm9tcHQ6IGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgc3RyZWFtOiB0cnVlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoIW9sbGFtYVJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT2xsYW1hIEFQSSBlcnJvcicpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnN0IHJlYWRlciA9IG9sbGFtYVJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpXHJcbiAgICAgICAgICBpZiAoIXJlYWRlcikgdGhyb3cgbmV3IEVycm9yKCdObyByZXNwb25zZSBib2R5JylcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgbGV0IGFzc2lzdGFudFJlc3BvbnNlID0gJydcclxuICAgICAgICAgIGxldCBidWZmZXIgPSAnJ1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpXHJcbiAgICAgICAgICAgIGlmIChkb25lKSBicmVha1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYnVmZmVyICs9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZSh2YWx1ZSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gYnVmZmVyLnNwbGl0KCdcXG4nKVxyXG4gICAgICAgICAgICBidWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJ1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcbiAgICAgICAgICAgICAgaWYgKCFsaW5lLnRyaW0oKSkgY29udGludWVcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UobGluZSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucmVzcG9uc2UgJiYgZGF0YS5yZXNwb25zZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIGFzc2lzdGFudFJlc3BvbnNlICs9IGRhdGEucmVzcG9uc2VcclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHNzZURhdGEgPSBgZGF0YTogJHtKU09OLnN0cmluZ2lmeSh7IHRva2VuOiBkYXRhLnJlc3BvbnNlIH0pfVxcblxcbmBcclxuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKHNzZURhdGEpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5kb25lID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgICAgICAgICAgICAgICAgJ0lOU0VSVCBJTlRPIG1lc3NhZ2VzIChpZCwgY2hhdF9pZCwgcm9sZSwgY29udGVudCkgVkFMVUVTICgkMSwgJDIsICQzLCAkNCknLFxyXG4gICAgICAgICAgICAgICAgICAgIFt1dWlkdjQoKSwgY2hhdElkLCAnYXNzaXN0YW50JywgYXNzaXN0YW50UmVzcG9uc2VdXHJcbiAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VDb3VudCA9IGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgICAgICAgICAgICAgICAgJ1NFTEVDVCBDT1VOVCgqKSBGUk9NIG1lc3NhZ2VzIFdIRVJFIGNoYXRfaWQgPSAkMScsXHJcbiAgICAgICAgICAgICAgICAgICAgW2NoYXRJZF1cclxuICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KG1lc3NhZ2VDb3VudC5yb3dzWzBdLmNvdW50KSA9PT0gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gY29udGVudC5sZW5ndGggPiA1MCA/IGNvbnRlbnQuc3Vic3RyaW5nKDAsIDUwKSArICcuLi4nIDogY29udGVudFxyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBvb2wucXVlcnkoXHJcbiAgICAgICAgICAgICAgICAgICAgICAnVVBEQVRFIGNoYXRzIFNFVCB0aXRsZSA9ICQxIFdIRVJFIGlkID0gJDInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgW3RpdGxlLCBjaGF0SWRdXHJcbiAgICAgICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICBjb25zdCBkb25lRGF0YSA9IGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KHsgZG9uZTogdHJ1ZSB9KX1cXG5cXG5gXHJcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShkb25lRGF0YSkpXHJcbiAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04gcGFyc2UgZXJyb3I6JywgZSwgJ0xpbmU6JywgbGluZSlcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignU3RyZWFtaW5nIGVycm9yOicsIGVycm9yKVxyXG4gICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogJ0ZhaWxlZCB0byBnZW5lcmF0ZSByZXNwb25zZScgfSl9XFxuXFxuYFxyXG4gICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGVycm9yRGF0YSkpXHJcbiAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShzdHJlYW0sIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9ldmVudC1zdHJlYW0nLFxyXG4gICAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJyxcclxuICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJyxcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgbWVzc2FnZTonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHNlbmQgbWVzc2FnZScgfSwgeyBzdGF0dXM6IDUwMCB9KVxyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwb29sIiwidjQiLCJ1dWlkdjQiLCJQT1NUIiwicmVxdWVzdCIsInBhcmFtcyIsImNoYXRJZCIsImNvbnRlbnQiLCJqc29uIiwicXVlcnkiLCJlbmNvZGVyIiwiVGV4dEVuY29kZXIiLCJzdHJlYW0iLCJSZWFkYWJsZVN0cmVhbSIsInN0YXJ0IiwiY29udHJvbGxlciIsIm9sbGFtYVJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtb2RlbCIsInByb21wdCIsIm9rIiwiRXJyb3IiLCJyZWFkZXIiLCJnZXRSZWFkZXIiLCJhc3Npc3RhbnRSZXNwb25zZSIsImJ1ZmZlciIsImRvbmUiLCJ2YWx1ZSIsInJlYWQiLCJUZXh0RGVjb2RlciIsImRlY29kZSIsImxpbmVzIiwic3BsaXQiLCJwb3AiLCJsaW5lIiwidHJpbSIsImRhdGEiLCJwYXJzZSIsInJlc3BvbnNlIiwibGVuZ3RoIiwic3NlRGF0YSIsInRva2VuIiwiZW5xdWV1ZSIsImVuY29kZSIsIm1lc3NhZ2VDb3VudCIsInBhcnNlSW50Iiwicm93cyIsImNvdW50IiwidGl0bGUiLCJzdWJzdHJpbmciLCJkb25lRGF0YSIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJlcnJvckRhdGEiLCJjbG9zZSIsIlJlc3BvbnNlIiwic3RhdHVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/[chatId]/message/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.js":
/*!*******************!*\
  !*** ./lib/db.js ***!
  \*******************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

eval("\nconst { Pool } = __webpack_require__(/*! pg */ \"pg\");\nconst pool = new Pool({\n    host: \"localhost\",\n    port: 5432,\n    user: \"postgres\",\n    password: \"Mdasad\",\n    database: \"chatgpt_local\",\n    ssl: false\n});\nmodule.exports = pool;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIuanMiLCJtYXBwaW5ncyI6IjtBQUFBLE1BQU0sRUFBRUEsSUFBSSxFQUFFLEdBQUdDLG1CQUFPQSxDQUFDO0FBRXpCLE1BQU1DLE9BQU8sSUFBSUYsS0FBSztJQUNwQkcsTUFBTTtJQUNOQyxNQUFNO0lBQ05DLE1BQU07SUFDTkMsVUFBVTtJQUNWQyxVQUFVO0lBQ1ZDLEtBQUs7QUFDUDtBQUVBQyxPQUFPQyxPQUFPLEdBQUdSIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbG9jYWwtY2hhdGdwdC1vbGxhbWEvLi9saWIvZGIuanM/M2RjOSJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IFBvb2wgfSA9IHJlcXVpcmUoJ3BnJyk7XHJcblxyXG5jb25zdCBwb29sID0gbmV3IFBvb2woe1xyXG4gIGhvc3Q6ICdsb2NhbGhvc3QnLFxyXG4gIHBvcnQ6IDU0MzIsXHJcbiAgdXNlcjogJ3Bvc3RncmVzJyxcclxuICBwYXNzd29yZDogJ01kYXNhZCcsXHJcbiAgZGF0YWJhc2U6ICdjaGF0Z3B0X2xvY2FsJyxcclxuICBzc2w6IGZhbHNlLFxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcG9vbDsiXSwibmFtZXMiOlsiUG9vbCIsInJlcXVpcmUiLCJwb29sIiwiaG9zdCIsInBvcnQiLCJ1c2VyIiwicGFzc3dvcmQiLCJkYXRhYmFzZSIsInNzbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/uuid"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&page=%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2F%5BchatId%5D%2Fmessage%2Froute.ts&appDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmdasa%5CDesktop%5CollamaChat&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();